"use strict";!function(){var e=document.getElementById("menu-burger"),t=document.getElementById("back-to-top"),n=document.querySelector("header"),r=document.querySelector("body"),s=e.querySelector(".content"),a=document.querySelector(".splide"),o=document.querySelectorAll("nav a"),i=document.getElementById("filters-button"),c=document.getElementById("show-results"),l=document.getElementById("load-fp-spin"),d=function(){var e,t=document.createElement("fakeelement"),n={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in n)if(void 0!==t.style[e])return n[e]};function u(){l.style.display="block"}function m(){l.style.display="none"}var p,h;function f(){r.classList.contains("active")?(r.classList.remove("active"),s.innerHTML="Menu"):(r.classList.add("active"),s.innerHTML="Fermer")}document.addEventListener("focus",function(e){var t;e.target.closest(".ais-SearchBox-input")&&(t=document.querySelector("#clear-refinements-show-all button"),e=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window}),t.dispatchEvent(e))},!0),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),o.forEach(function(e){e.addEventListener("click",function(e){f()})}),null!==i&&(i.addEventListener("click",function(e){r.classList.add("show-filters")}),c.addEventListener("click",function(e){r.classList.remove("show-filters"),g(100)}),new Date,p={appId:"5IKVY0BULC",apiKey:"e3c22f5936c0f7947f4a61ecee808f70",indexName:"NEUFMOINSCHERV2"},(h=instantsearch({indexName:p.indexName,numberLocale:"fr",searchParameters:{facetingAfterDistinct:!0,attributesToSnippet:["extended:40"]},searchClient:algoliasearch(p.appId,p.apiKey),routing:{router:instantsearch.routers.history({createURL:function(e){var t=e.qsModule,n=e.routeState,s=e.location.href.match(/^(.*?)\/rechercher/),e="".concat(s?s[1]:"","/"),s={};n.query&&(s.query=encodeURIComponent(n.query)),1!==n.page&&(s.page=n.page),n.marques&&(s.marques=n.marques.map(encodeURIComponent)),n.modeles&&(s.modeles=n.modeles.map(encodeURIComponent)),n.carrosseries&&(s.carrosseries=n.carrosseries.map(encodeURIComponent)),n.options&&(s.options=n.options.map(encodeURIComponent));s=t.stringify(s,{addQueryPrefix:!0,arrayFormat:"repeat"});return"".concat(e,"rechercher").concat(s)},parseURL:function(e){var t=e.qsModule,n=e.location,s=(n.pathname.match(/rechercher\/(.*?)\/?$/),t.parse(n.search.slice(1))),a=s.query,r=void 0===a?"":a,e=s.page,t=s.marques,n=void 0===t?[]:t,a=s.carrosseries,t=void 0===a?[]:a,a=s.modeles,a=void 0===a?[]:a,s=s.options,s=void 0===s?[]:s,n=Array.isArray(n)?n:[n].filter(Boolean),t=Array.isArray(t)?t:[t].filter(Boolean),s=Array.isArray(s)?s:[s].filter(Boolean),a=Array.isArray(a)?a:[a].filter(Boolean);return{query:decodeURIComponent(r),page:e,marques:n.map(decodeURIComponent),modeles:a.map(decodeURIComponent),carrosseries:t.map(decodeURIComponent),options:s.map(decodeURIComponent)}}}),stateMapping:{stateToRoute:function(e){e=e[p.indexName]||{};return{query:e.query,page:e.page,marques:e.refinementList&&e.refinementList.marque,modeles:e.refinementList&&e.refinementList.modele,carrosseries:e.refinementList&&e.refinementList.carrosserie,options:e.refinementList&&e.refinementList.options}},routeToState:function(e){return{NEUFMOINSCHERV2:{query:e.query,page:e.page,refinementList:{marque:e.marques,modele:e.modeles,carrosserie:e.carrosseries,options:e.options}}}}}}})).addWidgets([instantsearch.widgets.clearRefinements({container:"#clear-refinements",templates:{resetLabel:"Supprimer les filtres"}}),instantsearch.widgets.clearRefinements({container:"#clear-refinements-show-all",templates:{resetLabel:"Voir tous nos véhicules"}}),instantsearch.widgets.searchBox({container:"#searchbox",placeholder:"Que recherchez-vous ? Renault Clio Blanc,..."}),instantsearch.widgets.hits({container:"#hits",templates:{item:'\n                    <a href="/voiture/{{slug}}" class="{{classStock}} {{etat_class}}">\n                        <img src="data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' viewBox=\'0 0 300 225\'%3E%3C/svg%3E" data-src="/thumbs/690x518/{{photo}}" data-srcset="/thumbs/300x225/{{photo}} 300w, /thumbs/447x335/{{photo}} 768w, /thumbs/447x335/{{photo}} 1024w" alt="{{name}}" class="lazyload" data-sizes="auto" width="690" height="518">\n                        <span class="label {{disponibilite_class}}">{{disponibilite}}</span>\n                        <span class="label label-etat {{etat_class}}">{{etat}}</span>\n                        <div class="block">\n                            <div class="title">\n                                <div class="h2">{{{marque}}} {{modele}}</div>\n                                <div class="infos">\n                                    <span>{{type_boite}}</span>\n                                    <span>{{energie}}</span>\n                                </div>\n                            </div>\n                            <div class="subtitle">{{version}}</div>\n\n                            <div class="price">\n                                <div class="promotion">-{{remise}}%</div>\n                                <div class="amount">{{#helpers.formatNumber}}{{prix_ttc_affiche}}{{/helpers.formatNumber}} €</div>\n                                <div class="loa">\n                                    <span>à partir de</span> {{#helpers.formatNumber}}{{mensualite}}{{/helpers.formatNumber}} €<small>/mois</small>\n                                    <img src="/img/ico_info.svg" class="toggle-modal" alt="infos" data-id="modalAjax" data-ajax="/mentions-legales/{{reference}}" width="15" height="15">\n                                </div>\n                            </div>\n                        </div>\n                    </a>\n                    ',empty:'\n                    <div id="no-results-message">\n                        <p>Nous n\'avons trouvé aucun résultat pour la recherche <em>"{{query}}"</em>.</p>\n                        <a href="rechercher" class=\'clear-all\'>Effacer la recherche</a>\n                    </div>\n                    '},cssClasses:{item:"car",list:"listing-cars"}}),instantsearch.widgets.stats({container:"#stats",templates:{text:"\n                    {{#hasNoResults}}Aucun véhicule{{/hasNoResults}}\n                    {{#hasOneResult}}1 véhicule{{/hasOneResult}}\n                    {{#hasManyResults}}{{#helpers.formatNumber}}{{nbHits}}{{/helpers.formatNumber}} véhicules{{/hasManyResults}}\n                    "}}),instantsearch.widgets.stats({container:"#show-results",templates:{text:"\n                    {{#hasNoResults}}Voir le listing{{/hasNoResults}}\n                    {{#hasOneResult}}Voir le véhicule trouvé{{/hasOneResult}}\n                    {{#hasManyResults}}Voir nos {{#helpers.formatNumber}}{{nbHits}}{{/helpers.formatNumber}} véhicules{{/hasManyResults}}\n                    "}}),instantsearch.widgets.voiceSearch({container:"#voicesearch"}),instantsearch.widgets.pagination({container:"#pagination",padding:1}),instantsearch.widgets.sortBy({container:"#sort-by-selector",autoHideContainer:!0,items:[{value:p.indexName,label:"Trier par le + pertinent"},{value:p.indexName+"_price_asc",label:"Trier par le - cher"},{value:p.indexName+"_price_desc",label:"Trier par le + cher"},{value:p.indexName+"_remise_desc",label:"Trier par remise"},{value:p.indexName+"_mensualite_asc",label:"Trier par mensualité la - cher"},{value:p.indexName+"_mensualite_desc",label:"Trier par mensualité le + cher"}]}),instantsearch.widgets.refinementList({container:"#brand",attribute:"marque",operator:"or",sortBy:["isRefined","name:asc","count:desc"],limit:200,searchForFacetValues:{placeholder:"Rechercher par marques",templates:{noResults:'<div class="sffv_no-results">Pas de marques correspondantes.</div>'}}}),instantsearch.widgets.refinementList({container:"#options",attribute:"options",operator:"and",sortBy:["isRefined","count:desc","name:asc"],limit:200,searchForFacetValues:{placeholder:"Rechercher par marques",templates:{noResults:'<div class="sffv_no-results">Pas de marques correspondantes.</div>'}}}),instantsearch.widgets.refinementList({container:"#gamme",attribute:"modele",operator:"or",limit:400,sortBy:["isRefined","name:asc","count:desc"],searchForFacetValues:{placeholder:"Rechercher par modèles",templates:{noResults:'<div class="sffv_no-results">Pas de modèles correspondantes.</div>'}},templates:{showMoreText:"\n                      {{#isShowingMore}}\n                        En voir moins\n                      {{/isShowingMore}}\n                      {{^isShowingMore}}\n                        En voir plus\n                      {{/isShowingMore}}\n                    "}}),instantsearch.widgets.refinementList({container:"#carrosserie",attribute:"carrosserie",operator:"or",sortBy:["isRefined","count:desc","name:asc"],searchForFacetValues:{placeholder:"Rechercher par carrosserie",templates:{noResults:'<div class="sffv_no-results">Pas de carrosseries correspondantes.</div>'}},templates:{header:E("Carrosserie")}}),instantsearch.widgets.rangeSlider({container:"#price",attribute:"prix_ttc_affiche",templates:{header:E("Prix")},tooltips:{format:function(e){return Math.round(e).toLocaleString()+"€"}}}),instantsearch.widgets.rangeSlider({container:"#mensualite",attribute:"mensualite",templates:{header:E("Mensualité")},tooltips:{format:function(e){return Math.round(e).toLocaleString()+"€"}}}),instantsearch.widgets.rangeSlider({container:"#co2",attribute:"emissionco2",templates:{header:E("Mensualité")},tooltips:{format:function(e){return Math.round(e).toLocaleString()+" gr"}}}),instantsearch.widgets.refinementList({container:"#type",attribute:"type_boite",operator:"and",templates:{header:E("Boite de Vitesse")}}),instantsearch.widgets.refinementList({container:"#carburant",attribute:"energie",operator:"or",templates:{header:E("Carburant")}})]),h.start()),document.addEventListener("submit",function(e){var t,n,s,a=e.target.closest(".submitAjax");a&&(e.preventDefault(),u(),t=document.getElementById("modal-ajax"),(n=new FormData(a)).append("_token",document.querySelector('meta[name="csrf-token"]').content),(s=new XMLHttpRequest).open("POST",a.getAttribute("action"),!0),s.onreadystatechange=function(){4==this.readyState&&200==this.status&&(t.innerHTML=this.responseText,m())},s.send(n)),(a=e.target.closest(".submitDriiveme"))&&(e.preventDefault(),u(),t=document.getElementById("driiveme"),(n=new FormData(a)).append("_token",document.querySelector('meta[name="csrf-token"]').content),(s=new XMLHttpRequest).open("POST",a.getAttribute("action"),!0),s.onreadystatechange=function(){4==this.readyState&&200==this.status&&(t.innerHTML=this.responseText,m())},s.send(n))}),document.addEventListener("click",function(e){if(e.target.closest(".js-consent-notice-close"))document.querySelector(".js-consent-notice").style.display="none";else{var t=e.target.closest("a[href]");if(t&&t.matches("a[href], a[href] *")){if(1<e.which||e.metaKey||e.ctrlKey||e.shiftKey)return;if((n=t)&&n.href&&(["http:","https:"].includes(n.protocol)&&(("http:"!=n.protocol||"https:"!=location.protocol)&&((!n.hash||n.pathname+n.search!=location.pathname+location.search)&&(-1==n.href.indexOf("#")&&(-1==n.href.indexOf("?page=")&&-1==n.href.indexOf("rechercher")))))))return void(t.getAttribute("target")||(console.log(t.getAttribute("href")),u()))}var n,s,a=e.target.closest(".toggle-modal");a&&(e.preventDefault(),n=document.getElementById(a.getAttribute("data-id")),(t=a.getAttribute("data-ajax"))&&(n||(u(),(e=document.createElement("div")).setAttribute("id","modalAjax"),e.setAttribute("class","modal"),e.innerHTML='<div class="modal-content"><span class="close toggle-modal" data-id="modalAjax">&times;</span><div id="modal-ajax"></div></div>',r.append(e),n=document.getElementById(a.getAttribute("data-id"))),s=document.getElementById("modal-ajax"),(a=new XMLHttpRequest).onreadystatechange=function(){4==this.readyState&&200==this.status&&(s.innerHTML=this.responseText,m())},a.open("GET",t),a.send()),n.classList.contains("active")?n.classList.remove("active"):n.classList.add("active"))}},!1),e.onclick=function(){f()};var v=0;function g(n){var s=window.pageYOffset/2,a=0,r=performance.now();window.requestAnimationFrame(function e(t){(a+=Math.PI/(n/(t-r)))>=Math.PI&&window.scrollTo(0,0),0!==window.pageYOffset&&(window.scrollTo(0,Math.round(s+s*Math.cos(a))),r=t,window.requestAnimationFrame(e))})}window.addEventListener("scroll",function(){var e=document.documentElement.scrollTop;e>n.offsetHeight?t.classList.add("show"):t.classList.remove("show"),2<v-e?n.classList.remove("is-hidden"):2<e-v&&e>n.offsetHeight&&n.classList.add("is-hidden"),v=e},{passive:!0}),t.addEventListener("click",function(){g(500)}),null!==a&&new Splide(".splide",{perPage:1,pagination:!1,interval:5e3,autoplay:!0,preloadPages:0,lazyLoad:"nearby",rewind:!0}).mount();function y(e,t){if(e.classList.contains("collapsed"))return t.classList.remove("is-visible"),(n=e).style.height=n.scrollHeight+"px",window.setTimeout(function(){n.style.height="0",n.classList.remove("collapsed")},1),window.addEventListener("transitionend",function e(t){"height"!==!t.propertyName&&(n.classList.remove("is-visible"),window.removeEventListener("transitionend",e,!1))},!1),0;var n;t.classList.add("is-visible"),function(n){var e=function(){n.style.display="block";var e=n.scrollHeight+"px";return n.style.display="",e}();n.classList.add("is-visible"),n.style.height=e;var s=d();window.addEventListener(s,function e(t){"height"!==!t.propertyName&&(n.style.height="",n.classList.add("collapsed"),window.removeEventListener(s,e,!1))},!1)}(e)}document.addEventListener("click",function(e){var t=e.target;(t=!t.href?function(e,t){for(;e.parentNode;)if((e=e.parentNode)[t])return e;return null}(t,"href"):t)&&t.classList.contains("toggle")&&(e.preventDefault(),(t=document.querySelector(e.target.hash))&&y(t,e.target))},!1);var w,a=document.querySelector(".geolocate");null!==a&&((w=new google.maps.places.Autocomplete(document.getElementById("route"),{types:["address"]})).setFields(["address_component"]),w.setComponentRestrictions({country:["fr"]}),w.addListener("place_changed",L),a.addEventListener("focus",function(e){navigator.geolocation&&navigator.geolocation.getCurrentPosition(function(e){var t={lat:e.coords.latitude,lng:e.coords.longitude},e=new google.maps.Circle({center:t,radius:e.coords.accuracy});w.setBounds(e.getBounds())})}));var b={street_number:"short_name",locality:"long_name",postal_code:"short_name"};function L(){var e,t,n=w.getPlace();for(e in b)document.getElementById(e).value="";for(var s=0;s<n.address_components.length;s++){var a=n.address_components[s].types[0];b[a]&&(document.getElementById(a).value=n.address_components[s][b[a]]);var r=n.address_components[s].long_name;"street_number"==a&&(t=r+" "),"route"==a&&(t+=r)}document.getElementById("route").value=t}function E(e){return"<h5>"+e+"</h5>"}"loading"!==document.readyState?m():document.addEventListener("DOMContentLoaded",function(){m()}),document.addEventListener&&window.addEventListener("pageshow",function(e){(e.persisted||window.performance&&2==window.performance.navigation.type)&&m()},!1)}();